{% extends "base.html" %}

{% block page_title %}Sucursales{% endblock %}

{% block page_subtitle %}Gestiona cada una de tus sucursales.{% endblock %}

{% block page_actions %}{% endblock %}

{% block content %}
  <section class="panel">
    <div class="panel-header">
      <h2>Sucursales</h2>
      <span class="pill">{{ stores|length }} total</span>
    </div>
    <div class="panel-body">
      <form method="post" class="form-stack">
        {{ form.hidden_tag() }}
        <label>
          Nombre de la sucursal
          {{ form.name(class_="input") }}
          {% if form.name.errors %}
            <span class="field-error">{{ form.name.errors[0] }}</span>
          {% endif %}
        </label>
        <button class="button" type="submit">Crear sucursal</button>
      </form>
      {% if stores %}
        <div class="table-wrap table-scroll">
          <table class="table table-mobile-cards">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Creada</th>
                <th>Estado</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for store in stores %}
                <tr>
                  <td data-label="Nombre">{{ store.name }}</td>
                  <td data-label="Creada">{{ store.created_at.strftime("%d/%m/%Y") if store.created_at else "" }}</td>
                  <td data-label="Estado">
                    {% if active_store and active_store.id == store.id %}
                      <span class="status success">Activa</span>
                    {% else %}
                      <span class="status muted">Disponible</span>
                    {% endif %}
                  </td>
                  <td class="table-actions table-actions-cell" data-label="Acciones">
                    <a class="button button-ghost button-compact" href="{{ url_for('main.stores_detail', store_id=store.id) }}">Ver</a>
                    <a class="button button-ghost button-compact" href="{{ url_for('main.stores_edit', store_id=store.id) }}">Editar</a>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="empty-state">
          <h3>No hay sucursales</h3>
          <p class="muted">Crea la primera sucursal para empezar a cargar trabajos.</p>
        </div>
      {% endif %}
    </div>
  </section>
{% endblock %}
