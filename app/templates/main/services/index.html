{% extends "base.html" %}

{% block page_title %}Services{% endblock %}
{% block page_subtitle %}Vista general de todos los service{% endblock %}

{% block page_actions %}
  <a class="button" href="{{ url_for('main.services_create') }}">Nuevo service</a>
{% endblock %}

{% block content %}
  <section class="panel panel-table">
    <div class="panel-header">
      <h2>Services disponibles</h2>
      <span class="pill">{{ services|length }} total</span>
    </div>
    <div class="panel-body">
      {% if services %}
        <div class="table-wrap table-scroll">
          <table class="table table-mobile-cards table-services">
            <thead>
              <tr>
                <th class="col-service-name">Nombre</th>
                <th class="col-service-price">Precio base</th>
                <th class="col-service-status">Estado</th>
                <th class="col-service-actions"></th>
              </tr>
            </thead>
            <tbody>
              {% for service in services %}
                <tr>
                  <td class="col-service-name cell-wrap" data-label="Nombre">
                    <div class="table-title">{{ service.name }}</div>
                    <div class="muted">
                      {{ service.description|default("Sin descripcion")|truncate(50, True, "...") }}
                    </div>
                  </td>
                  <td class="col-service-price" data-label="Precio base">$ {{ service.base_price|currency }}</td>
                  <td class="col-service-status" data-label="Estado">
                    {% if service.is_active %}
                      <span class="status success">Activo</span>
                    {% else %}
                      <span class="status muted">Pausado</span>
                    {% endif %}
                  </td>
                  <td class="col-service-actions table-actions-cell" data-label="Acciones">
                    <div class="table-actions">
                      <a class="button button-ghost button-compact" href="{{ url_for('main.services_detail', service_id=service.id) }}">Ver</a>
                      <a class="button button-ghost button-compact" href="{{ url_for('main.services_edit', service_id=service.id) }}">Editar</a>
                      <form method="post" action="{{ url_for('main.services_delete', service_id=service.id) }}" class="inline-form js-confirm" data-confirm-title="Eliminar service" data-confirm-message="Esta accion no se puede deshacer. Â¿Confirmas la eliminacion?" data-confirm-final-accept="Eliminar">
                        {{ delete_form.hidden_tag() }}
                        <button class="button button-danger icon-button button-compact" type="submit" aria-label="Eliminar">
                          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M3 6h18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 6V4h8v2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 6l1 14h10l1-14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                        </button>
                      </form>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="empty-state">
          <h3>No hay services aun</h3>
          <p class="muted">Crea tus servicios base y precios para cotizar trabajos.</p>
          <a class="button" href="{{ url_for('main.services_create') }}">Crear service</a>
        </div>
      {% endif %}
    </div>
  </section>
{% endblock %}
