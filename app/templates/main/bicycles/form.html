{% extends "base.html" %}

{% block page_title %}{{ title }}{% endblock %}

{% block page_actions %}
  <a class="button button-ghost" href="{{ url_for('main.bicycles') }}">Volver</a>
{% endblock %}

{% block content %}
  <section class="panel">
    <div class="panel-header">
      <h2>{{ title }}</h2>
      <span class="pill">Bicicletas</span>
    </div>
    <div class="panel-body">
      <form method="post" class="form-stack">
        {{ form.hidden_tag() }}
        <div class="form-grid">
          <label>
            Cliente
            {{ form.client_id(class_="input") }}
          </label>
          <label>
            Marca
            <span class="field-desktop">
              {{ form.brand_text(class_="input", list="brand-list", placeholder="Buscar marca") }}
            </span>
            <span class="field-mobile">
              {{ form.brand_select(class_="input") }}
            </span>
            <datalist id="brand-list">
              {% for value, label in form.brand_select.choices %}
                {% if value %}
                  <option value="{{ value }}">{{ label }}</option>
                {% endif %}
              {% endfor %}
            </datalist>
          </label>
          <label>
            Modelo
            {{ form.model(class_="input") }}
          </label>
          <label>
            Descripcion
            {{ form.description(class_="input") }}
          </label>
        </div>
        <div class="form-actions">
          <button class="button" type="submit">{{ submit_label }}</button>
          <a class="button button-ghost" href="{{ url_for('main.bicycles') }}">Cancelar</a>
        </div>
      </form>
      <script>
        const desktopField = document.querySelector(".field-desktop input");
        const mobileField = document.querySelector(".field-mobile select");

        const toggleBrandInputs = () => {
          const isMobile = window.matchMedia("(max-width: 980px)").matches;
          if (desktopField && mobileField) {
            desktopField.disabled = isMobile;
            mobileField.disabled = !isMobile;
          }
        };

        toggleBrandInputs();
        window.addEventListener("resize", toggleBrandInputs);
      </script>
    </div>
  </section>
{% endblock %}
